{
  "processors": [
    {
      "pipeline": {
        "name": "enrich-accounts",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.containsKey('accountID')"
      }
    },
    {
      "pipeline": {
        "name": "enrich-austinbanks",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.containsKey('addressID')"
      }
    },
    {
      "pipeline": {
        "name": "enrich-austinstores",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.containsKey('posID')"
      }
    },
    {
      "pipeline": {
        "name": "enrich-austinswift",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.containsKey('txbankId')"
      }
    },
    {
      "pipeline": {
        "name": "enrich-intbank",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.containsKey('intbankID')"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "account_event",
        "target_field": "account.event"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "account_type",
        "target_field": "account.type"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "deposit_type",
        "target_field": "deposit.type"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "event_amount",
        "target_field": "event.amount"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "event_type",
        "target_field": "event.type"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "transaction_date",
        "target_field": "transaction.date"
      }
    },
    {
      "rename": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "wire_direction",
        "target_field": "wire.direction"
      }
    },
    {
      "set": {
        "ignore_failure": true,
        "field": "@timestamp",
        "copy_from": "transaction.date"
      }
    },
    {
      "pipeline": {
        "name": "enrich-inbound",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.wire?.direction == 'inbound' || ctx.wire?.direction == 'incoming_domestic'"
      }
    },
    {
      "pipeline": {
        "name": "enrich-outbound",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx.wire?.direction == 'outbound' || ctx.wire?.direction == 'outgoing_domestic' || ctx.wire?.direction == 'outgoing_international'"
      }
    },
    {
      "remove": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": "atm.pin_attempts",
        "if": "ctx?.atm?.event == 'status_check' && ctx?.atm?.available == true && ctx?.atm?.online == true"
      }
    },
    {
      "pipeline": {
        "name": "atm-cleanup",
        "ignore_missing_pipeline": true,
        "ignore_failure": true,
        "if": "ctx?.atm?.available == false"
      }
    },
    {
      "set": {
        "ignore_failure": true,
        "field": "atm.online",
        "value": false,
        "if": "ctx.atm?.available == false"
      }
    },
    {
      "remove": {
        "ignore_failure": true,
        "ignore_missing": true,
        "field": [
          "business_hours",
          "txbankId",
          "timestamp",
          "accountID",
          "1.accountID",
          "4.txbankId",
          "3.posID",
          "5.intbankID",
          "addressId",
          "intbankID",
          "posID",
          "account_event",
          "account_type",
          "deposit_type",
          "event_amount",
          "event_type",
          "wire_direction",
          "transaction_date",
          "to_account",
          "enrich-outbounds.accountID"
        ]
      }
    }
  ]
}
